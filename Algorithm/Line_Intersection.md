# 선분 교차판정
두 선분이 교차하고 있는지 판정하는 알고리즘이다. <br/>

## 방법
두 선분 AB, CD에 대해, <br/>
CCW(A, B, C) * CCW(A, B, D) <= 0 && CCW(C, D, A) * CCW(C, D, B) <= 0이면 교차한다.

## 원리
일단 두 선분의 관계는 다음과 같다. <br/>
1. 평행하다
2. 한점에서 만난다 (강한 의미의 교차한다)
3. 여러점에서 만나거나 포함 또는 일치한다 (약한 의미의 교차한다)
4. 만나지 않지만 평행하지 않다

위 상태를 확인하는 방법은 [CCW](https://github.com/SuhYC/Lesson/blob/main/Algorithm/CCW.md)알고리즘을 사용한다. <br/>
두 선분을 확장하여 직선으로 만드는 것으로 먼저 예시를 들자면, <br/>

두 선분 중 하나를 기준으로, 다른 선분의 두 정점이 해당 선분의 왼쪽에 있는지, 오른쪽에 있는지, 직선위에 있는지를 파악한다. <br/>

두 정점이 모두 왼쪽에 있거나, 모두 오른쪽에 있다면, 해당 경우는 두 선분이 만나지 않는다. <br/>

그리고 기준을 바꿔서 반대 경우도 해보아야하는게, <br/>
```
          c
a --- b   |
          d
```
와 같은 케이스가 있을 수 있다. <br/>
ab를 기준으로 c와 d를 각각 CCW했을 때에는 부호가 서로 달라 교차하는 것처럼 보였지만, <br/>
cd를 기준으로 a와 b를 각각 CCW했을 때에는 모두 왼쪽에 있는 상태이므로 교차하지 않는다.

# 교차점 찾기
일반적으로 직선의 방정식이 주어지면 바로 연립방정식과 행렬을 이용해 교차하는 점을 구할 수 있다. <br/>
하지만 선분의 양 끝점이 주어진다면 어떻게 구해야할까? <br/>

## 방법
일단 2개의 선분 $\overline{P_0P_1}$, $\overline{Q_0Q_1}$을 가정하자. <br/>
두 선분이 1개의 점에서만 만난다고 가정하면, 선분을 내분하는 두 점 ```Pt```와 ```Qs```가 일치하면 된다. <br/>
```Pt = P0 + t(P1 - P0)```, $0 \leq t \leq 1$ <br/>
```Qs = Q0 + u(Q1 - Q0)```, $0 \leq u \leq 1$ <br/>
```Pt = Qs = P0 + t(P1 - P0) = Q0 + u(Q1 - Q0)``` <br/>
```P0```, ```P1```, ```Q0```, ```Q1```은 상수벡터이므로 ```P1 - P0 = R```, ```Q1 - Q0 = S```, ```Q0 - P0 = D```와 같이 치환하면, <br/>
```tR - uS = D```와 같이 정리가 가능하다. <br/>
여기서 R, S, D는 상수벡터이므로 x성분과 y성분을 분리하여 2개의 식으로 표현 가능하다. <br/>
```tRx - uSx = Dx```, ```tRy - uSy = Dy``` <br/>
이 두 식을 행렬로 표현하면 t와 u를 구할 수 있다. <br/>

```
[Rx -Sx][t] = [Dx]
[Ry -Sy][u] = [Dy]
```

역행렬로 풀 수 있는지 ```det = SxRy - RxSy = 0```를 통해 검증 가능하며, ```det = 0```이면 두 선분이 평행하다는 의미가 된다. <br/>
```det != 0``` 이라면 다음과 같이 정리할 수 있다. <br/>

```
[t] =  1 [-Sy Sx][Dx]
[u] = det[-Ry Rx][Dy]

t = 1/det * (SxDy - DxSy), u = 1/det * (RxDy - DxRy)
```

이를 조금 더 다듬기 위해 2차원에서의 외적을 ```cross(a, b) = axby - aybx```로 정의하면, <br/>
```t = cross(d,s) / cross(r,s) , u = cross(d,r) / cross(r,s)``` 까지 정리가 가능하다. <br/>
해당 t값을 이용해서 ```Pt```를 구해주면 된다. <br/>

그리고 ```det = 0```인 경우 평행하다는 의미였으니 1개의 점에서 만나려면 선분 양 끝점중 하나는 일치하고 다른 하나는 서로 반대방향으로 배치되어야한다.
